# elbencho bash completion

# echo shortopts (incl. single dash) and longopts (incl. double dash).
_elbencho_opts()
{
   local shortopts longopts

   shortopts="
        -b
        -c
        -d
        -D
        -F
        -h
        -i
        -n
        -N
        -r
        -s
        -t
        -w
        "

   longopts="
        --allelapsed
        --althttpsvc
        --backward
        --block
        --blockvaralgo
        --blockvarpct
        --clients
        --clientsfile
        --configfile
        --cores
        --cpu
        --csvfile
        --cufile
        --cufiledriveropen
        --cuhostbufreg
        --deldirs
        --delfiles
        --direct
        --dirs
        --dirsharing
        --dirstats
        --dropcache
        --dryrun
        --fadv
        --files
        --foreground
        --gdsbufreg
        --gpuids
        --gpuperservice
        --help
        --help-all
        --help-bdev
        --help-dist
        --help-large
        --help-multi
        --help-s3
        --hosts
        --hostsfile
        --infloop
        --interrupt
        --iodepth
        --iterations
        --lat
        --lathisto
        --latpercent
        --latpercent9s
        --limitread
        --limitwrite
        --live1
        --live1n
        --livecsv
        --livecsvex
        --liveint
        --log
        --madv
        --mkdirs
        --mmap
        --netbench
        --netdevs
        --no0usecerr
        --nocsvlabels
        --nodelerr
        --nodetach
        --nodiocheck
        --nofdsharing
        --nolive
        --nopathexp
        --nosvcshare
        --numservers
        --opslog
        --opsloglock
        --perthread
        --phasedelay
        --port
        --preallocfile
        --quit
        --rand
        --randalgo
        --randalign
        --randamount
        --rankoffset
        --read
        --recvbuf
        --resfile
        --respsize
        --rotatehosts
        --rwmixpct
        --rwmixthr
        --s3aclget
        --s3aclgrantee
        --s3aclgrants
        --s3aclgtype
        --s3aclput
        --s3aclverify
        --s3baclget
        --s3baclput
        --s3endpoints
        --s3fastget
        --s3key
        --s3listobj
        --s3listobjpar
        --s3listverify
        --s3log
        --s3objprefix
        --s3randobj
        --s3region
        --s3secret
        --s3transman
        --sendbuf
        --servers
        --serversfile
        --service
        --sharesize
        --size
        --start
        --stat
        --svcupint
        --sync
        --threads
        --timelimit
        --treefile
        --treerand
        --treeroundup
        --trunc
        --trunctosize
        --verify
        --verifydirect
        --version
        --write
        --zones
        "

    echo "$shortopts $longopts"
}

_elbencho()
{
    local cur prev opts
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    
    opts="$(_elbencho_opts)"
 
    case "${prev}" in
        # options that take a string argument
        -b)
        ;&
        --block)
        ;&
        --blockvaralgo)
        ;&
        --blockvarpct)
        ;&
        --cores)
        ;&
        --dirs)
        ;&
        --fadv)
        ;&
        --files)
        ;&
        --gpuids)
        ;&
        -i)
        ;&
        --iterations)
        ;&
        --iodepth)
        ;&
        --latpercent9s)
        ;&
        --limitread)
        ;&
        --limitwrite)
        ;&
        --liveint)
        ;&
        --log)
        ;&
        --madv)
        ;&
        -N)
        ;&
        -n)
        ;&
        --netdevs)
        ;&
        --numservers)
        ;&
        --phasedelay)
        ;&
        --port)
        ;&
        --randalgo)
        ;&
        --randamount)
        ;&
        --rankoffset)
        ;&
        --recvbuf)
        ;&
        --respsize)
        ;&
        --rotatehosts)
        ;&
        --rwmixpct)
        ;&
        --rwmixthr)
        ;&
        -s)
        ;&
        --s3aclgrantee)
        ;&
        --s3aclgrants)
        ;&
        --s3aclgtype)
        ;&
        --s3endpoints)
        ;&
        --s3key)
        ;&
        --s3listobj)
        ;&
        --s3objprefix)
        ;&
        --s3region)
        ;&
        --s3secret)
        ;&
        --sendbuf)
        ;&
        --sharesize)
        ;&
        --size)
        ;&
        --start)
        ;&
        --svcupint)
        ;&
        -t)
        ;&
        --threads)
        ;&
        --timelimit)
        ;&
        --treeroundup)
        ;&
        --verify)
        ;&
        --zones)
            return 0
        ;;

        # options that take a file/dir argument
        -c)
        ;&
        --clientsfile)
        ;&
        --configfile)
        ;&
        --csvfile)
        ;&
        --hostsfile)
        ;&
        --livecsv)
        ;&
        --opslog)
        ;&
        --resfile)
        ;&
        --serversfile)
        ;&
        --treefile)
            compopt -o filenames 2>/dev/null
            COMPREPLY=( $(compgen -f ${cur}) )
            return 0
        ;;

        # options that take a hostname argument
        --clients)
        ;&
        --hosts)
        ;&
        --servers)
            compopt -o nospace 2>/dev/null
            COMPREPLY=( $(compgen -A hostname ${cur}) )
            return 0
        ;;

        # all others
        *)
        ;;
    esac

    if [[ "${cur}" = -* ]]; then
        compopt -o filenames 2>/dev/null
        COMPREPLY=( $(compgen -f -W "${opts}" -- ${cur}) )
    else
        compopt -o filenames 2>/dev/null
        COMPREPLY=( $(compgen -f -W "" -- ${cur}) )
    fi
}

complete -F _elbencho elbencho
